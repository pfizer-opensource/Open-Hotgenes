% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Hotgenes.R
\name{HotgenesDRomics}
\alias{HotgenesDRomics}
\title{Exports DRomics DE analysis to Hotgenes}
\usage{
HotgenesDRomics(
  bmdcalc = NULL,
  auxiliary_assays = NULL,
  Expression_name = "Normalized_data",
  Mapper = NULL,
  pseudocount = 1e-06
)
}
\arguments{
\item{bmdcalc}{object returned by [DRomics::bmdcalc()]}

\item{auxiliary_assays}{Additional assays to include in the 
Hotgenes object (optional)}

\item{Expression_name}{Character string naming the expression
data assay (default: "Normalized_data")}

\item{Mapper}{Optional mapper object for feature annotation}

\item{pseudocount}{Numeric value (default is 1e-6) 
used to calculate max/extreme dose and baseline}
}
\value{
A Hotgenes object containing: 
  \itemize{
    \item Output_DE: Differential expression results formatted for Hotgenes
    \item Normalized_Expression:  Expression data matrix
    \item coldata: Column metadata including dose information
    \item designMatrix: Model design matrix
    \item Original_Object: The original bmdcalc object
  }
}
\description{
This function converts DRomics benchmark dose modeling results into a 
Hotgenes object for downstream analysis and visualization.
}
\details{
This function processes DRomics benchmark dose calculation results 
and reformats them for use with Hotgenes. It handles both count-based
(e.g., RNA-seq) and continuous 
(e.g., metabolomics) data types.

For log2 fold change calculation: 
\itemize{
  \item Count data: Uses log2 ratio with 
  pseudocount (1e-6) between max/extreme dose and baseline
  \item Continuous data: Uses direct difference 
  between max/extreme dose and baseline
  \item Trends "bell" and "U": Uses extreme value (yextrem)
  \item Other trends: Uses value at maximum dose (yatdosemax)
}

The stat column is calculated as:  -log10(padj) * sign(log2FoldChange)
}
\examples{

library(DRomics)
library(Hotgenes)

# example with RNAseqdata -------------------------------------------------
datafilename <- system.file("extdata", "RNAseq_sample.txt", package="DRomics")
o <- DRomics::RNAseqdata(datafilename, check = TRUE, transfo.method = "vst")
s_quad <- DRomics::itemselect(o, select.method = "quadratic", FDR = 0.05)

f <- DRomics::drcfit(itemselect = s_quad, parallel = "no")

bmdcalc_out <- DRomics::bmdcalc(f)

# optional mapper
dbCon <- org.Mm.eg.db::org.Mm.eg_dbconn()

# Your query - joining ENSEMBL and gene_info
sqlQuery <- "SELECT * FROM ensembl, refseq, gene_info 
             WHERE ensembl._id == gene_info._id 
             AND refseq._id == gene_info._id;"

mapper <- DBI::dbGetQuery(dbCon, sqlQuery) \%>\%
  
  dplyr::select(c("Feature" = "accession", "ensembl_id", "gene_name", "symbol")) \%>\% 
  tibble::tibble()


hotDR_RNAseqdata <- HotgenesDRomics(
    bmdcalc = bmdcalc_out,
    Mapper = mapper)


# example with continuousomicdata -----------------------------------------
datafilename2 <- system.file("extdata", "metabolo_sample.txt", package = "DRomics")

con_o <- DRomics::continuousomicdata(datafilename2)

s_quad_2 <- DRomics::itemselect(con_o, select.method = "quadratic", FDR = 0.05)
f_2 <- DRomics::drcfit(itemselect = s_quad_2, parallel = "no")
bmdcalc_f_2 <- DRomics::bmdcalc(f_2)

hotDR_continuous <- HotgenesDRomics(
  bmdcalc = bmdcalc_f_2)

hotDR_continuous
}
